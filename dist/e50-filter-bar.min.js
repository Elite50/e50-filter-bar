/*! e50-filter-bar 2014-12-04 */
angular.module("e50Filter.tpls",["tpl/e50-filter-tpl.html"]),angular.module("tpl/e50-filter-tpl.html",[]).run(["$templateCache",function(a){a.put("tpl/e50-filter-tpl.html",'<div>\n  <div ng-if="bar.options.count">{{bar.getCount() || bar.data.length}} {{options.listLabel || \'Results\'}}</div>\n  \n  <div ng-if="bar.options.filters">\n    <select ng-model="bar.filter.key" ng-change="bar.filter.onchange()" ng-options="item[0] as item[1] for item in bar.filter.options" ng-if="bar.filter.hasOptions()"></select>\n  </div>\n\n  <div ng-if="bar.options.views">\n    <a href="" ng-repeat="view in bar.views.options" ng-click="bar.views.setView(view)">{{view}}</a>\n  </div>\n\n  <div ng-if="bar.options.sort">\n    <select ng-model="bar.sort.key" ng-change="bar.sort.onchange()" ng-options="item[0] as item[1] for item in bar.sort.options" ng-if="bar.sort.hasOptions()">\n    </select>\n    <a href="" ng-click="bar.sort.reverse()">flip</a>\n  </div>\n  \n  <div ng-if="bar.options.search">\n    <a href="" ng-click="bar.search.toggle()">toggle search</a>\n    <input type="text" placeholder="Filter search" ng-if="bar.search.isOpen()" ng-model="bar.search.text">\n  </div>\n\n  <div ng-if="bar.options.actions">\n    <select ng-model="bar.actions.key" ng-change="bar.actions.onchange()" ng-options="item[0] as item[1] for item in bar.actions.options" ng-if="bar.actions.hasOptions()"></select>\n  </div>\n</div>')}]),angular.module("e50FilterBar",["e50Filter.tpls"]),angular.module("e50FilterBar").directive("e50FilterBar",function(){return{restrict:"EA",replace:!0,priority:1,transclude:!0,terminal:!0,scope:{bar:"=filterBar"},templateUrl:"tpl/e50-filter-tpl.html"}}),angular.module("e50FilterBar").factory("E50Count",function(){function a(){this.value=0,this.label="Results"}return{"new":function(b){return new a(b)}}}),angular.module("e50FilterBar").factory("E50Dropdown",["E50Toggle",function(a){function b(b){angular.extend(this,a),this.options=[],this.key="id",this.getKey=function(){return this.key},this.setKey=function(a){this.key=a},this.setOptions=function(a){this.options=a},this.hasOptions=function(){return this.options.length},this.onChange=function(a){this.onchange=a},this.onchange=angular.noop,angular.extend(this,b)}return{"new":function(a){return new b(a)}}}]),angular.module("e50FilterBar").factory("E50Filter",["E50Dropdown","E50Count","E50Views","E50Search",function(a,b,c,d){function e(e){this.options={count:!0,filters:!0,views:!0,sort:!0,search:!0,actions:!0},angular.extend(this.options,e),this.options.count&&(this.count=b.new()),this.options.filters&&(this.filter=a.new({key:"all"})),this.options.views&&(this.views=c.new()),this.options.sort&&(this.sort=a.new({key:"name",_reverse:!1,reverse:function(){this._reverse=!this._reverse}})),this.options.actions&&(this.actions=a.new()),this.options.search&&(this.search=d.new({text:"",placeholder:"Search"})),this.fetch=function(){this.fetchParams={sort:this.sort.key,filter:this.filter.key,q:this.search.text}}.bind(this)}return{"new":function(a){return new e(a)}}}]),angular.module("e50FilterBar").factory("E50Search",["E50Toggle",function(a){function b(b){angular.extend(this,a),this.text="",this.placeholder="Search",setPlaceholder=function(a){this.placeholder=a},angular.extend(this,b)}return{"new":function(a){return new b(a)}}}]),angular.module("e50FilterBar").factory("E50Toggle",function(){return{_open:!1,isOpen:function(){return this._open},open:function(){this._open=!0},close:function(){this._open=!1},toggle:function(){this._open=!this._open}}}),angular.module("e50FilterBar").factory("E50Views",function(){function a(a){this.view="table",this.options=[],this.setViews=function(a){this.options=a},this.setView=function(a){this.view=a.toLowerCase()},this.isView=function(a){return this.view===a},this.getView=function(){return this.view},this.setDefault=this.setView,angular.extend(this,a)}return{"new":function(b){return new a(b)}}});